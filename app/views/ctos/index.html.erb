<script type="text/javascript">
    function MapData (addresses,titles,descriptions, lats,lngs){
        this.addresses = addresses;
        this.titles = titles;
        this.descriptions = descriptions;
        this.lats = lats;
        this.lngs = lngs;
    }
    var addresses = [];
    var titles = [];
    var descriptions = [];
    var lats = [];
    var lngs = [];

    <% @ctos.each do |cto| %>
        addresses.push("<%=cto.address%>");
        titles.push("<%=cto.name%>");
        titles.push("<%=cto.description%>");
        lats.push("<%=cto.latitude%>");
        lngs.push("<%=cto.longitude%>");
    <% end %>


     mapData = new MapData(addresses, titles, descriptions, lats, lngs);
    $(this).showRoutes(false,mapData);
</script>


<!--Form should perform a search according to distance and schedule.Let it be until schedule will not be implemented.TODO refactor search -->
<span class="LVSCarTypes">

   <!--Let's build custom search form -->
  <%= form_tag :controller => 'ctos', :action => 'index', :method => 'get' do |f|%>
        <span>
          <%= label_tag(:requestDate, "Дата запису") %>
          <%= text_field_tag(:requestDate)%>
         </span>

        <span>
          <%= label_tag(:requestTime, "Дата запису") %>
          <%= text_field_tag(:requestTime)%>
        </span>

        <span>
          <!-- If registered then we can enter it's location. Otherwise let's get gps to get into account search resutls. TODO: Let's make optional our location to build map to get -->
          Моє місцезнаходження: <input type="text" name="user location">
        </span>
       <span class="btn btn-default LVSSearchButton"><%= submit_tag("Search") %></span>
    <% end %>
  </span>

<div class="container" id="main">
  <div class="row">
    <div class="col-xs-6" id="left">

      <% @ctos.each do |cto| %>
         <div class="panel panel-info">
                <div class="panel-heading"><span style="font-weight:bold">Назва:</span><span><%= cto.name %></span></div>
                <div class="panel-body"><span style="font-weight:bold">Опис:</span><div><%= cto.description %></div>
                  <div style="font-weight:bold">Адреса:</span><span><%= cto.address %></div>
                  <div style="font-weight:bold">Контакти:</div><div><%= cto.contacts %></div>
                  <div style="clear:both;width:100%;text-align:right">
                    <span style="margin-right:1px;width:32%;font-size:10px;text-align:right"><%= link_to 'Переглянути розклад', cto_path(cto), class: 'btn btn-default', style: 'font-size:10px' %></span>
                  </div>
                </div>
         <div>
     </div>
  </div>
  <% end %>

      <%= paginate @ctos %>
</div>

</div>
  <div id="route_map" style="display:block;position:absolute">
    <div id="map_canvas" style="width:400px;height:400px"></div>
  </div>
</div>



